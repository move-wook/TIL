# HikariCP를 이용한 DB 커넥션 풀 관리 🏊

## 1. 커넥션 풀(Connection Pool)이란?

애플리케이션이 DB와 통신할 때마다 새로운 연결을 생성하는 것은 비용이 매우 큽니다.  
→ 이 문제를 해결하기 위해 **커넥션 풀**이라는 기술이 사용됩니다.

### 💡 정의
- DB 연결(Connection)을 미리 여러 개 생성해두고 **풀(Pool)**에 저장
- 사용 시 빌려 쓰고, 종료 후 다시 반납
- 매번 새로운 커넥션을 생성하는 과정(TCP 핸드셰이크, 인증 등)을 피하여 **성능 향상**

---

## 2. HikariCP란?

**HikariCP**는 Java 진영에서 사용하는 **초고속, 고성능 JDBC 커넥션 풀 라이브러리**입니다.

- ‘Hikari’는 일본어로 ‘빛’을 의미하며, 이름처럼 빠른 속도를 지향
- Spring Boot 2.0부터 기본 커넥션 풀로 채택됨
- Netflix, Spring, JetBrains 등 대규모 시스템에서 실전 검증됨

---

## 3. Spring Boot는 왜 HikariCP를 선택했는가?

기존에는 다음과 같은 커넥션 풀이 많이 사용됨:

| 기존 커넥션 풀 | 특징 |
|----------------|------|
| Apache Commons DBCP | 안정적이지만 느림 |
| Tomcat JDBC Pool | 톰캣 통합성 좋으나 성능은 보통 |
| C3P0 | 기능 풍부하지만 느리고 복잡 |

→ **HikariCP는 이들보다 월등히 뛰어난 성능**을 보여주며 등장했고,  
Spring Boot는 이를 **기본값**으로 채택하여 개발자들이 추가 설정 없이 최상의 성능을 누릴 수 있도록 했습니다.

---

## 4. HikariCP vs 다른 커넥션 풀

| 항목           | DBCP             | C3P0            | HikariCP         |
|----------------|------------------|------------------|------------------|
| 성능           | 느림              | 보통             | **매우 빠름**     |
| 설정 난이도     | 중간              | 어려움            | **간단함**        |
| 커스터마이징    | 제한적             | 다양함            | 적당함            |
| 스레드 처리     | 보통              | 느림              | **고성능**        |
| 유지보수        | 느리게 진행         | 거의 없음          | **활발**           |

---

## 5. HikariCP의 장단점

### ✅ 장점

- **압도적인 성능**  
  → 락 최소화, 바이트코드 최적화 등 저수준 튜닝으로 업계 최상급 속도
- **높은 안정성**  
  → 커넥션 누수 방지, 유휴 커넥션 관리 등 robust한 설계
- **간단한 설정**  
  → 대부분 기본값으로도 충분한 퍼포먼스
- **활발한 유지보수**  
  → Spring 공식 지원, 커뮤니티와 릴리즈가 빠름

### ❌ 단점

- **고급 커스터마이징 한계**  
  → 복잡한 연결 시나리오에선 옵션 부족할 수 있음
- **내부 구조가 복잡함**  
  → 디버깅이나 성능 튜닝 시 진입 장벽 있음

---

## 6. 언제 HikariCP를 선택하면 좋은가?

| 조건 | 적합 여부 |
|------|-----------|
| Spring Boot 사용 중인가? | ✅ |
| TPS가 높은 구조인가? | ✅ |
| 커넥션 병목이 자주 발생하는가? | ✅ |
| 설정을 단순하게 유지하고 싶은가? | ✅ |
| 매우 세밀한 커넥션 전략이 필요한가? | ❌ 다른 풀 고려 필요 |

---

## 7. 예시 설정 (Spring Boot)

### application.yml

```yaml
spring:
  datasource:
    url: jdbc:mysql://localhost:3306/app
    username: user
    password: pass
    driver-class-name: com.mysql.cj.jdbc.Driver
    hikari:
      maximum-pool-size: 20
      minimum-idle: 5
      idle-timeout: 30000
      connection-timeout: 30000
