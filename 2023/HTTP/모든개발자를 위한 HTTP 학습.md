# 모든 개발자를 위한 HTTP 학습 강의 정리 

## IP(인터넷 프로토콜)

 - IP는 주소 역할을 한다.

 - 편지를 주고 받거나 택배를 보낼때 주소가 필요한 것 처럼 네트워크 통신을 할 때도 어느 주소로 데이터를 보낼지에 대한 주소가 필요하다 그 역할이 IP이다.

 - 패킷(규칙)이라는 통신 단위로 데이터 전달을 한다.

 * 한계  

 - 비연결성   

    - 패킷을 받을 대상이 없거나 서비스 불능 상태여도 패킷 전송

 - 비신뢰성  

    - 중간에 패킷이 사라지면?  

    - 패킷이 순서대로 안오면?

 - 프로그램 구분

    - 같은 IP를 사용하는 서버에서 통신하는 애플리케이션이 둘 이상이면?

## TCP/UDP

  - 인터넷 프로토콜 스택 4계층
    - 애플리케이션 계층 : HTTP,FTP
    - 전송계층 : TCP,uDP
    - 인터넷계층 : IP
    - 네트워크계층


    - TCP 특징  
        - 전송 제어 프로토콜

        - 연결지향  : 연결을 하고 데이터를 전송한다.
            - TCP 3 way handshake(가상 연결)
            1. SYN : 접속 요청
            2. SYN + ACK :요청 수락
            3. ACK
        - 데이터 전달 보증
        - 순서 보장
        - 신뢰할 수 있는 프로토콜(신뢰성)

    - UDP 특징
    
        - 사용자 데이터그램 프로토콜
        - 단순하고 빠름
        - 기능이 거의 없음
        - IP와 거의 같고 + PORT가 추가됨 + 체크섬
        - 애플리케이션에서 추가 작업 필요

## PORT

    - 같은 IP 내에서 프로세스를 구분
    
        - 0 ~ 65535 할당가능
        - 0 ~ 1023: 잘 알려진 포트, 사용하지 않는 것이 좋음
            - FTP : 20,21
            - TELNET : 23
            - HTTP : 80
            - HTTPS : 443

## DNS

    - 도메인 네임 시스템 
    + IP는 기억하기 힘들다 
    + IP는 변경될 수 있다
     IP-> 도메인 네임으로 변환하면 도메인 네임으로 접근이 가능함

     - 도메인명을 IP주소로 변환


## URI(Uniform Resource Identifier)

    - URI? URL? URN?

    - URI 는 locator,name 또는 둘다 추가로 분류될 수 있다.


        - URL : Resource Locator  
             - foo://example.com:8042/over/there?name=ferret#nose
            foo: scheme
            example.com:8042 : authority
            over/there? : path
            name=ferret : query
            nose : fragment

            - Locator: 리소스가 있는 위치를 지정


        - URN : Resource Name 
            - urn:example:animal:ferret:nose

            - Name : 리소스에 이름을 부여
             
    - 단어의 뜻
    
    - Uniform: 리소스 식별하는 통일된 방식
    - Resource : 자원,URI로 식별할 수 있는 모든것
    - Identifier : 다른 항목과 구분하는데 필요한 정보

    - 전체 문법
     - scheme://[uerinfo@]host[:port][/path][?query][#fragment]

     - 프로토콜 : http
     - 호스트명 : www.google.com
     - 포트 번호 : 433
     - 패스 :/search
     - 쿼리 파라미터 : q=hello&hl=ko


## 웹 브라우저 요청 흐름

    https://www.google.com:443/search?q=hello&hl=ko

    - DNS 조회 : www.google.com
    - HTTP 요청 메세지 생성
    [
        GET/search?q=hello&hl=ko HTTP/1.1
        Host:www.google.com
    ]
    
    HTTP 메시지 전송
        
        1. 웹 브라우저가 HTTP 메시지 생성
        2. SOCKET 라이브러리를 통해 전달
            - A : TCP/IP 연결
            - B : 데이터 전달
        3. TCP/IP 패킷 생성, HTTP 메시지 포함
       

## HTTP
    
     - 모든것이 HTTP  

        HTTP 메시지에 모든 것을 전송
         - HTML, TEXT
         - IMAGE,음성,영상,파일
         - JSON,XML
         - 거의 모든 형태의 데이터 전송 가능
         - 서버간에 데이터를 주고 받을 때도 대부분  HTTP 사용
         - HTTP 시대

        특징 
            - 클라이언트 서버 구조
                
                [
                    - Request Response 구조
                    - 클라이언트는 서버에 요청을 보내고 ,응답을 대기
                    - 서버가 요청에 대한 결과를 만들어서 응답
                ]
                
            - 무상태 프로토콜

                스테이스리스
                [
                    - 서버가 클라이언트의 상태를 보존하지 않는다
                    - 장점 : 서버 확장성이 높다
                    - 단점 : 클라이언트가 추가 데이터 전송
                ]
                무상태는 응답 서버를 쉽게 바꿀 수 있다 - >무한한 서버 증설 가능

                비연결성
                [
                    - HTTP는 기본이 연결을 유지하지 않는 모델
                    - 일반적으로 초 단위 이하 빠른 속도로 응답
                    - 1시간 동안 수천명이 서비스를 사용해도 실제 서버에서 동시에 처리하는 요청은 수십개 이하로 매우 작음
                    - 서버 자원을 매우 효율적으로 사용 가능

                    한계와 극복
                    - TCP/IP 연결을 새로 맺어야 함 
                    - 웹 브라우저로 사이트를 요청하면 여러가지 데이터 자원을 함께 다운로드
                    - 지금은 HTTP 지속 연결로 문제 해결
                ]

                
            - HTTP 메시지

            
            - 단순함, 확장 가능

     - 클라이언트 서버 구조
     
     - Stateful, Stateless

     - 비 연결성  

     - HTTP 메시지


## HTTP 메서드 

    - 가장 중요한 것은 리소스 식별!

    - 리소스의 의미
     
    - 리소스와 해당 리소스를 대상으로 하는 행위을 분리

    - GET : 리소스 조회
        - 서버에 전달 하고 싶은 데이터는 query를 통해서 전달
        - 메시지 바디를 사용해서 데이터를 전달할 수 있지만, 지원하지 않는 곳이  많아서 권장하지 않는다.

    - POST : 요청 데이터 처리, 주로 등록
        - 메시지 바디를 통해 서버로 요청 데이터 전달
        - 서버는 요청 데이터를 처리
        - 메시지 바디를 통해 들어온 데이터를 처리하는 모든 기능을 수행한다
        - 주로 전달된 데이터로 신규 리소스 등록,프로세스 처리사용
        - google : 대상 리소스가 고유 한 의미 체계에 따라 요청에 포함 된 표현을 처리하도록 요청한다.
        1. 새 리소스 생성(등록)
        2. 요청 데이터 처리
        3. 다른 메서드로 처리하기 애매한 경우

    - PUT : 리소스를 대체, 해당 리소스가 없으면 생성 (update라고 생각)
        - 중요! 클라이언트가 리소스를 식별(key값이 존재한다. 어떤 리소스를  put을 할건지 알아야 그 해당 리소스를 덮어쓰기 할 수 있다.)
        - 완전히 대체한다. 덮어쓰기
        - 리소스가 없는 경우 새로 생성
        - 부분적인 정보를 수정하는 것이 아니라 전체적으로 정보를 덮어쓰기한다.(기존 리소스를 삭제하고 덮어쓴다. 부분만 수정할 수 없다.)
    - PATCH : 리소스 부분 변경 (변경하고 싶은 부분만)
        - 리소스의 부분을 변경하고 싶을때는 PATCH를 사용한다.
    - DELETE : 리소스 삭제

    - HEAD : GET과 동일 하지만 메시지 부분을 제외하고 상태 줄과 헤더만 반환
    - OPTIONS : 대상 리소스에 대한 통신 가능 옵션을 설명
    - CONNECT : 대상 자원으로 식별되는 서버에 대한 터널을 설정
    - TRACE : 대상 리소스에 대한 경로를 따라 메시지 루프백 테스트를 수행

    - HTTP 메서드의 속성
        
        - 안전
            
            - 호출해도 리소스를 변경하지 않는다.
            
        - 멱등

            - 한번 호출하든 두 번 호출하든 100번 호출하든 결고가ㅏ 똑같아야한다.(GET,PUT,DELETE) !!POST는 멱등이 아니다.

            - 활용은 자동 복구 메커니즘 서버가 정상 응답을 주지 못했을 경우 클라이언트가 같은 요청을 해도 되는가?

            - 멱등은 외부 요인으로 중간에 리소스가 변경되는 것 까지 고려하지 않는다.
        
        - 캐시가능

            - 응답 결과를 캐시해서 사용 할 수 있는가

            - GET, HEAD,POST,PATCH 캐시가능
            - 실제는 GET,HEAD정도만 사용함


## 클라이언트에서 서버로 데이터 전송

 - 쿼리 파라미터를 통한 데이터 전송
    - GET 
    - 주로 정렬 필터

 - 메시지 바디를 통한 데이터 전송

    - POST,PUT,PATCH
    
    - 회원 가입,상품 주문, 리소스 등록,리소스 변경
 
 - HTML Form 데이터 전송

    - submit 시 post 전송 get도 가능

    - Content-Type : application/x-www-form-urlencoded 사용
        - form의 내용을 메시지 바디를 통해서 전송
        - 전송 데이터를 url encoding 처리
    - Content-Type:multipart/form-data
        - 파일 업로드 같은 바이너리 데이터 전송시 사용
        - 다른 종류의 여러 파일과 폼의 내용 함께 전송가능
    - HTML Form전송은 GET,POST만 지원함

- HTTP API
    -  서버 to 서버

    -  앱 클라이언트

    -  웹 클라이언트
        - HTML 에서 FROM 전송 대신 스크립트를 통한 AJAX를 사용
    -  Content-Type:application/json을 주로 사용 (사실상 표준)     

## HTTP API 설계 예시  

    - POST
     
        - 클라이언틑 등록될 리소스의 URI를 모른다
        - 서버가 새로 등록된 리소스 URI를 생성해준다
        - 컬렉션
            - 서버가 관리하는 리소스 디렉토리
            - 서버가 리소스의 URI를 생성하고 관리
            - (/)가 컬렉션
    - PUT

        - 클라이언트가 리소스 URI를 알고 있어야 한다 (키값을 알고 있어야한다.)
        - 클라이언트가 직접 리소스의 URI를 지정한다.
        - 스토어
            - 클라이언트가 관리하는 리소스 저장소
            - 클라이언트가 리소스의 URI를 알고 관리
    - HTML FROM 사용
        - HTML FORM은 GET,POST만 지원
        - 컨트롤 URI
            - GET,POST만 지원
            - 리소스 경로 사용
            - HTTP 메서드로 해결하기 애매한 경우 사용(HTTP API 포함)   

## HTTP 상태 코드
     클라이언트가 보낸 요청의 처리 상태를 응답하는 기능

    - 1xx :요청이 수신되어 처리중

    - 2xx : 요청 정상 처리 (성공)

        - 200 : ok [요청이 성공]
        - 201 : Create [요청이 성공해서 새로운 리소스가 생성됨]
        - 202 : Accepted [요청이 접수되었으나 처리가 완료되지 않았음]
        - 204 : No Content [서버가 요청을 성공적으로 수행했지만,응답 페이로드 본문에 보낼 데이터가 없음]

    - 3xx : 요청을 완료하려면 추가 행동이 필요
        리다이렉션 : 웹 브라우저는 3xx 응답 결과에 location 헤더가 있으면 location 위치로 자동 이동

        종류 :영구,일시,특수
            
            - 영구 : 특정 리소스의 URI가 영구적으로 이동
                
                - 리소스의 URI가 영구적으로 이동
                - 원래 URL을 사용x 검색 엔진 등에서도 변경 인지
                - 301 : Moved Permanently : 리다이렉트시 요청 메서드가 get으로 변함
                - 308 : Permanently Redirect : 301과 기능은 같음 리다이렉트시 요청 메서드와 본문 유지

            - 일시 : 일시적인 변경 post/redirect/get

                - 리소스의 URI가 일시적으로 변경
                - 따라서 검색 엔진 등에서 URL을 변경하면 안도미

                - 302 : Found : 리다이렉트시 요청 메소드가 get으로 변하고 본문이 제거될 수 있음
                - 307 : Temporary Redirect : 기능은 302와 같음 리다이렉트시 요청 메서드와 본문 유지
                - 303 : See Other :기능은 302와 같음 리다이렉트시에 요청 메서드가 GET으로 변경
                - PRG : Post/Redirect/Get
                    post를 보내면 redirect를 사용해라 주문후에 새로고침을 하면 중복 주문이 발생하는 예시를 볼 수 있음
                    - post로 주문후 새로 고침을 하면 중복주문방지
                    - post로 주문후 주문 결과 화면을 get 메서드로 리다이렉트
                    - 새로고침해도 결과 화면 get으로 조회
            - 특수 : 결과 대신 캐시를 사용 
                - 300 : 안쓴다
                - 304 : 캐시를 목적으로 사용,클라이언트에게 리소스가 수정되지 않았음을 알려준다.클라이언트는 로컬 pc에 저장된 캐시를 재사용한다. 304 응답은 응답에 메시지 바디를 포함하면 안된다.
                - 조건부 GET,HEAD 요청시 사용

        
    
    - 4xx : 클라이언트 오류 잘못된 문법등 서버가 요청을 수행할 수 없음

        - 오류의 원인이 클라이언트에 있음
        - 중요! 클라이언트가 이미 잘못된 요청, 데이터를 보내고 있기 때문에 ,똑같은 재시도가 실패함 (5xx랑 차이점은 똑같은 요청을 보내더라도 400은 실패 500은 성공할 수있음)

        - 400 Bad Request
            
            - 요청 구문, 메시지 등등

            - 클라이언트는 요청 내용을 다시 검토하고 보내야함
        - 401 : Unauthorized 
            - 클라이언트가 해당 리소스에 대한 인증이 필요함
            - 인증이 되지 않음
            - 인증 : 본인이 누구인지 확인,
            - 인가 : 권한 부여 
        - 403 : Forbidden 서버가 요청을 이해했지만 승인을 거부함
            -   주로 인증 자격 증명은 있지만, 접근 권한이 불충분한 경우
        - 404 : Not Found 요청 리소스를 찾을 수 없음
            - 요청 리소스가 서버에 없음
            - 클라이언트가 권한이 부족한 리소스에 접근할 떄 해당 리소스를 숨기고 싶을 때      
    - 5xx : 서버오류 서버가 정상 요청을 처리하지 못함
        - 서버 문제로 오류 발생
        - 서버에 문제가 있기 때문에 재시도 하면 성공할 수도 있음
        
        - 500 : Internal Server Error 
            - 서버 내부 문제로 오류 발생
        - 503 : Service Unavailable 서비스 이용 불가
            - 서버가 일시적인 과부하 또는 예정된 작업으로 잠시 요청을 처리 할 수 없음


## HTTP 헤더

    - 일반 헤더

        - HTTP 헤더 
        - HTTP 전송에 필요한 모든 부가 정보(메시지바디의 내용,메시지 바디의 크기,압축,인증,요청 클라이언트,서버 정보,캐시관리)
        - HTTP BODY(최신)
            - 메시지 본문을 통해 표현 데이터 전달
            - 메시지 본문 = 페이로드
            - 표현은 요청이나 응답에서 전달할 실제 데이터
            - 표현 헤더는 표현 데이터를 해석할 수 있는 정보 제공
                - 데이터 유형,데이터 길이,압축 정보
            - 표현헤더는 표현 메타데이터와 페이로드 메시지를 구분해야하지만 
        - 표현
            - Content-Type: 표현 데이터의 형식
                - 미디어 타입,문자 인코딩 (text/html; charset=utf-8),application/json 
            - Content-Encoding : 표현 데이터 압축 방식
                - 표현 데이터를 압축하기 위해 사용
                - 데이터를 전달하는 곳에서 압축 후 인코딩 헤더 추가
                - 데이터를 읽는 쪽에서 인코딩 헤더의 정보로 압축 해제
            - Content-Language: 표현 데이터의 자연 언어
                - 표현 데이터의 자연 언어를 표현
            - Content-Length : 표현 데이터의 길이
                - 바이트 단위
                - Transfer-Encoding을 사용하면 Cotent-Length를 사용하면 안됨

            - 표현 헤더는 전송,응답 둘다 사용

        - 협상 : 클라이언트가 선호하는 표현 요청

            - Accept : 클라이언트가 선호하는 미디어 타입 전달
            - Accept-Charset : 클라이언트가 선호하는 문자 인코딩
            - Accept-Encoding :  클라이언트가 선호하는 압축 인코딩
            - Accept-Language :  클라이언트가 선호하는 자연 언어

            - Quality Values 협상과 우선 순위
            - 0 ~ 1 클수록 높은 우선순위 
            - 생략하면 1
            - Accpet-Language : ko-KR,ko;q=0.9,en-Us;q=0.8,en;q=0.7

            - 협상과 우선순위 2
            - 구체적인 것이 우선
            - Accept : text/*,text/plain,text/plain;format=flowed,*/*


            - 협상과 우선순위 3
            - 구체적인 것을 기준으로 미디어 타입을 맞춘다.
        

        - 전송 방식

            - 단순 전송 : Content-Length = 컨텐트의 길이를 알 수 있을 때 단순하게 전송한다.
            - 압축 전송 : Content-Encoding = 단순전송을 압축해서 전송하면 파일이 크기를 작게 전송가능 
            - 분할 전송 : Transfer-Encoding = 데이터를 원하는 바이트씩 잘라서 보낼 수 있음 # Content-Length를 넣으면 안된다!!
            - 범위 전송 : Range,Content-Rang = 범위를 지정해서 전송한다.

        - 일반 정보

            - From : 유저 에이전트의 이메일 정보
                - 일반적으로 잘 사용되지 않음
                - 검색 엔진 같은 곳에서, 주로 사용
                - 요청에서 사용

            - Referer: 이전 웹 페이지 주소
                - 현재 요청된 페이지의 이전 웹 페이지 주소
                - A -> B 로 이동하는 경우 B를 요청할 때 Referer: A를 포함해서 요청
                - Referer를 사용해서 유입 경로 분석 가능
                - 요청에서 사용

            - User-Agent : 유저 에이전트 애플리케이션 정보
                - 클라이언트의 애플리케이션 정보 (웹 브라우저, 정보)
                - 통계 정보
                - 어떤 종류의 브라우저에서 장애가 발생하는지 파악 가능
                - 요청에서 사용

            - Server : 요청을 처리하는 ORIGIN 서버의 소프트웨어 정보
                - Server : Apache/2.2.22
                - server : nginx
                - 응답에서 사용

            -Date  : 메시지가 발생한 날짜와 시간
                - 응답에서 사용





        - 특별한 정보

            - Host : 요청안 호스트 정보
                - 요청에서 사용
                - 필수
                - 하나의 서버가 여러 도메인을 처리해야 할 때
                - 하나의 IP 주소에 여러 도메인이 적용되어 있을 때

            - Location : 페이지 리다이렉션
            
            - Allow : 허용 가능한 HTTP 메서드
                - 405에서 응답에 포함해야함
            
            - Retry-After : 유저 에이전트가 다음 요청을 하기까지 기다려야 하는 시간
                - 503: 서비스가 언제까지 불능인지 알려줄 수 있음
                
        - 인증

            - Authorization : 클라이언트 인증 정보를 서버에 전달
                - Authorization :Basic xxxxxxxxxxx
            - WWW-Authenticate : 리소스 접근시 필요한 인증 방법 정의
                - 리소스 접근시 필요한 인증 방법 정의
                - 401 Unauthorized 응답과 함께 사용