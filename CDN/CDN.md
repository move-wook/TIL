# 📘 TIL - CDN 개념과 Push / Pull 방식, 사용 시 고려사항

## ✅ 1. CDN(Content Delivery Network) 이란?
- 전 세계에 분산된 서버를 통해 **사용자에게 가까운 위치에서 콘텐츠를 제공**하는 네트워크
- 주로 **정적 콘텐츠(CSS, JS, 이미지 등)** 전달, 경우에 따라 **동적 콘텐츠**도 처리 가능
- 목적:
  - 페이지 로딩 속도 향상
  - 원본 서버 부하 감소
  - 통신 지연 최소화
- 대표 서비스:
  - AWS CloudFront
  - CloudFlare
  - Akamai 등

---

## 🔄 2. Push 방식 vs Pull 방식

### 📦 Push 방식
- 원본 서버가 콘텐츠를 **사전에 CDN에 업로드**
- 콘텐츠 업데이트 시 **직접 갱신 필요**

**장점**
- 콘텐츠가 CDN에 미리 존재하여 응답 속도 빠름
- 정확한 버전 제어 가능

**단점**
- 콘텐츠 변경 시 수동 업데이트 필요
- 관리/운영 부담 ↑

---

### 🌐 Pull 방식
- 사용자의 요청이 있을 때 **CDN이 원본 서버에서 콘텐츠를 가져와 캐싱**
- 이후 요청은 CDN이 응답

**장점**
- 설정 간단, 자동화 쉬움
- 자주 요청되는 콘텐츠만 캐싱하여 효율적

**단점**
- 첫 요청 시 응답 지연 가능
- 원본 서버 상태에 따라 초기 응답 성능 영향

---

## 🧠 3. CDN 사용 시 고려할 점

### 💰 비용
- 대부분 **사용량 기반 과금**
- 비용 대비 효과 분석 필요
- 꼭 필요한 리소스만 캐싱하여 최적화

### ⏳ 콘텐츠 만료 시간(Cache TTL)
- TTL이 너무 길면: 오래된 콘텐츠 노출
- TTL이 너무 짧으면: 원본 서버 부하 증가
- 상황에 맞는 TTL + 버저닝 전략 병행 고려

### 🔁 장애 대응
- CDN 장애 발생 시 **원본 서버 fallback** 고려
- 대체 경로 설정 및 테스트 필수

### ❌ 콘텐츠 무효화(Invalidation)
- 방법:
  - 오브젝트 버저닝 (e.g. `main.v2.js`)
  - CDN Invalidation API 활용
- 배포 자동화와 함께 사용하면 효율적

---

## ✅ 요약
- CDN은 웹 성능과 가용성을 위한 핵심 인프라 구성 요소
- Push: 정교한 제어 가능 / 관리 복잡
- Pull: 유연한 운영 / 첫 요청 느릴 수 있음
- TTL, 비용, 장애 대응, 무효화 전략 등 **운영 고려사항 많음**
